<!-- c:\0124newSIm\src\templates\dashboard.html -->
{% extends "base.html" %}

{% block content %}
<div class="dashboard-grid">
    <!-- 経営情報サマリ -->
    <div class="card card-large">
        <div class="card-header">
            <h2>自分の企業の経営情報サマリ・アラート</h2>
        </div>
        <div class="card-body">
            <div class="stat-row">
                <span class="label">現金残高</span>
                <span class="value">¥{{ "{:,}".format(funds|int) }}</span>
            </div>
            <div class="stat-row">
                <span class="label">従業員数</span>
                <span class="value">{{ emp_count }} 名</span>
            </div>
            
            {% if alerts %}
            <div class="alert-box">
                {% for alert in alerts %}
                <p class="alert-text">⚠ {{ alert }}</p>
                {% endfor %}
            </div>
            {% else %}
            <p class="text-muted">現在、重要なアラートはありません。</p>
            {% endif %}
            
            <div class="card-footer">
                <a href="{{ url_for('sales') }}" class="link-text">クリックすると、経理画面にジャンプ</a>
            </div>
        </div>
    </div>

    <!-- ニュースフィード -->
    <div class="card card-large">
        <div class="card-header">
            <h2>世界のニュースフィード</h2>
        </div>
        <div class="card-body">
            <ul class="news-list">
                {% for item in news %}
                <li class="news-item">
                    <span class="news-date">{{ item.week | format_week }}</span>
                    <span class="news-content">{{ item.message }}</span>
                </li>
                {% else %}
                <li class="news-item">ニュースはありません。</li>
                {% endfor %}
            </ul>
            <div class="card-footer">
                <a href="{{ url_for('world') }}" class="link-text">クリックすると、ニュース画面にジャンプ</a>
            </div>
        </div>
    </div>

    <!-- 世界情勢サマリ -->
    <div class="card">
        <div class="card-header">
            <h2>世界情勢サマリ</h2>
        </div>
        <div class="card-body">
            <p>景気: {{ economic_status }}</p>
            <div class="card-footer">
                <a href="{{ url_for('world') }}" class="link-text">世界画面へ</a>
            </div>
        </div>
    </div>

    <!-- 人事サマリ -->
    <div class="card">
        <div class="card-header">
            <h2>自分の企業の人事サマリ</h2>
        </div>
        <div class="card-body">
            <div class="stat-row">
                <span class="label">従業員数</span>
                <span class="value">{{ emp_count }} 名</span>
            </div>
            <div class="stat-row">
                <span class="label">平均忠誠度</span>
                <span class="value">{{ avg_loyalty|int }}</span>
            </div>
            <div class="card-footer">
                <a href="{{ url_for('hr') }}" class="link-text">人事画面へ</a>
            </div>
        </div>
    </div>

    <!-- 生産サマリ -->
    <div class="card">
        <div class="card-header">
            <h2>自分の企業の生産サマリ</h2>
        </div>
        <div class="card-body">
            <p>今週の生産指示数: {{ production_this_week }} 台</p>
            <div class="card-footer">
                <a href="{{ url_for('production') }}" class="link-text">生産画面へ</a>
            </div>
        </div>
    </div>

    <!-- 在庫サマリ -->
    <div class="card">
        <div class="card-header">
            <h2>在庫サマリ</h2>
        </div>
        <div class="card-body">
            <p>総在庫数: {{ "{:,}".format(total_inventory) }} 台</p>
            
            <ul class="news-list" style="margin-top: 10px;">
                {% for item in inventory_details %}
                <li class="news-item" style="justify-content: space-between;">
                    <span>{{ item.product_name }}</span>
                    <span>{{ "{:,}".format(item.quantity) }}</span>
                </li>
                {% endfor %}
            </ul>

            <div class="card-footer">
                <a href="{{ url_for('production') }}" class="link-text">生産画面へ</a>
            </div>
        </div>
    </div>

    <!-- 労働市場サマリ -->
    <div class="card">
        <div class="card-header">
            <h2>労働市場サマリ</h2>
        </div>
        <div class="card-body">
            <p>失業率: {{ "%.1f"|format(unemployment_rate) }}%</p>
            <div class="card-footer">
                <a href="{{ url_for('hr') }}" class="link-text">採用画面へ</a>
            </div>
        </div>
    </div>
    
    <!-- B2B取引サマリ -->
    <div class="card">
        <div class="card-header">
            <h2>B2B取引サマリ</h2>
        </div>
        <div class="card-body">
            <p>未承認の注文: {{ pending_orders }} 件</p>
            <div class="card-footer">
                <a href="{{ url_for('sales') }}" class="link-text">営業画面へ</a>
            </div>
        </div>
    </div>

    <!-- 開発サマリ -->
    <div class="card">
        <div class="card-header">
            <h2>開発サマリ</h2>
        </div>
        <div class="card-body">
            {% if developing_project %}
            <p>進行中: {{ developing_project.name }}</p>
            {% else %}
            <p>進行中のプロジェクトはありません。</p>
            {% endif %}
            <div class="card-footer">
                <a href="{{ url_for('dev') }}" class="link-text">開発画面へ</a>
            </div>
        </div>
    </div>
</div>
{% endblock %}
